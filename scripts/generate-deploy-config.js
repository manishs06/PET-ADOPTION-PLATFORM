/**
 * Generate deployment configuration template
 * This creates a .env file with auto-generated secrets
 * You just need to fill in your API keys and credentials
 */

const crypto = require('crypto');
const fs = require('fs');

function generateSecret(length = 32) {
  return crypto.randomBytes(length).toString('hex');
}

console.log('\nğŸš€ Generating deployment configuration...\n');

// Generate secure secrets
const jwtSecret = generateSecret(32);
const adminSecret = generateSecret(32);

console.log('âœ… Generated JWT_SECRET');
console.log('âœ… Generated FIRST_ADMIN_SECRET\n');

// Create .env file template
const envContent = `# Render Environment Variables - Generated by deploy script
# Fill in your actual values below and copy to Render dashboard

# Render API Configuration (get from https://dashboard.render.com/account/api-keys)
RENDER_API_KEY=your_render_api_key_here
RENDER_SERVICE_ID=your_service_id_here

# Database (from MongoDB Atlas)
MONGODB_URI=your_mongodb_connection_string_here

# JWT Configuration
JWT_SECRET=${jwtSecret}
JWT_EXPIRE=7d

# Stripe Configuration (from https://dashboard.stripe.com/apikeys)
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here

# ImgBB Configuration (from https://api.imgbb.com/)
IMGBB_API_KEY=your_imgbb_api_key_here

# Frontend URL (update after deploying frontend)
FRONTEND_URL=https://your-frontend.onrender.com
CORS_ORIGIN=https://your-frontend.onrender.com

# Email Configuration (Gmail with App Password)
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=your_gmail_app_password_here
EMAIL_FROM=FourPaws <your_email@gmail.com>

# Admin Secret
FIRST_ADMIN_SECRET=${adminSecret}

# Auto-set values (don't change these)
NODE_ENV=production
PORT=10000
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
`;

fs.writeFileSync('.env', envContent);
console.log('âœ… Created .env file with auto-generated secrets\n');

console.log('ğŸ“‹ NEXT STEPS:\n');
console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n');
console.log('1. Open .env file and fill in your actual values:');
console.log('   - MongoDB URI (from MongoDB Atlas)');
console.log('   - Stripe keys (from Stripe dashboard)');
console.log('   - ImgBB API key');
console.log('   - Gmail credentials');
console.log('   - Render API key\n');
console.log('2. Deploy Backend to Render:');
console.log('   a) Go to https://dashboard.render.com');
console.log('   b) Click "New +" â†’ "Web Service"');
console.log('   c) Connect your GitHub repository');
console.log('   d) Settings:');
console.log('      â€¢ Name: fourpaws-backend');
console.log('      â€¢ Root Directory: FourPaws/backend');
console.log('      â€¢ Build Command: npm install');
console.log('      â€¢ Start Command: npm start');
console.log('      â€¢ Environment: Node');
console.log('   e) Add ALL environment variables from .env file');
console.log('   f) Deploy and copy your backend URL\n');
console.log('3. Deploy Frontend to Render:');
console.log('   a) Click "New +" â†’ "Static Site"');
console.log('   b) Connect GitHub repository');
console.log('   c) Settings:');
console.log('      â€¢ Name: fourpaws-frontend');
console.log('      â€¢ Root Directory: FourPaws/frontend');
console.log('      â€¢ Build Command: npm install && npm run build');
console.log('      â€¢ Publish Directory: dist');
console.log('   d) Add Environment Variables:');
console.log('      â€¢ VITE_API_BASE_URL=https://your-backend-url.onrender.com/api');
console.log('      â€¢ VITE_IMGBB_API_KEY=your_imgbb_key');
console.log('      â€¢ VITE_Payment_Gateway_PK=your_stripe_publishable_key');
console.log('   e) Deploy\n');
console.log('4. Update Backend CORS:');
console.log('   a) Go to backend service â†’ Environment');
console.log('   b) Update FRONTEND_URL and CORS_ORIGIN with frontend URL');
console.log('   c) Redeploy backend\n');
console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n');
console.log('ğŸ’¡ Your secrets are already generated in .env file!');
console.log('ğŸ’¡ Keep .env file safe - it contains secrets!\n');

